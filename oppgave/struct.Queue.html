<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `Queue` struct in crate `oppgave`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, Queue">

    <title>oppgave::Queue - Rust</title>

    <link rel="stylesheet" type="text/css" href="../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='index.html'>oppgave</a></p><script>window.sidebarCurrent = {name: 'Queue', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content struct">
<h1 class='fqn'><span class='in-band'>Struct <a href='index.html'>oppgave</a>::<wbr><a class='struct' href=''>Queue</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-62' class='srclink' href='../src/oppgave/src/lib.rs.html#225-230' title='goto source code'>[src]</a></span></h1>
<pre class='rust struct'>pub struct Queue {
    // some fields omitted
}</pre><div class='docblock'><p>A Queue allows to push new tasks or fetch and decode them for processing.</p>

<h2 id='push' class='section-header'><a href='#push'>Push</a></h2>
<p>Pushing new tasks to the queue encodes the given object and stores it in Redis for later
processing.</p>

<h2 id='example' class='section-header'><a href='#example'>Example</a></h2>
<pre class='rust rust-example-rendered'>
<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>RustcDecodable</span>, <span class='ident'>RustcEncodable</span>)]</span>
<span class='kw'>struct</span> <span class='ident'>Job</span> { <span class='ident'>id</span>: <span class='ident'>u64</span> }

<span class='kw'>let</span> <span class='ident'>client</span> <span class='op'>=</span> <span class='ident'>redis</span>::<span class='ident'>Client</span>::<span class='ident'>open</span>(<span class='string'>&quot;redis://127.0.0.1/&quot;</span>).<span class='ident'>unwrap</span>();
<span class='kw'>let</span> <span class='ident'>con</span> <span class='op'>=</span> <span class='ident'>client</span>.<span class='ident'>get_connection</span>().<span class='ident'>unwrap</span>();
<span class='kw'>let</span> <span class='ident'>producer</span> <span class='op'>=</span> <span class='ident'>Queue</span>::<span class='ident'>new</span>(<span class='string'>&quot;default&quot;</span>.<span class='ident'>into</span>(), <span class='ident'>con</span>);

<span class='ident'>producer</span>.<span class='ident'>push</span>(<span class='ident'>Job</span>{ <span class='ident'>id</span>: <span class='number'>42</span> });</pre>

<h2 id='fetch' class='section-header'><a href='#fetch'>Fetch</a></h2>
<p>A Queue provides a convenient <code>Iterator</code>-like interface over tasks:</p>

<pre class='rust rust-example-rendered'>
<span class='attribute'>#[<span class='ident'>derive</span>(<span class='ident'>RustcDecodable</span>, <span class='ident'>RustcEncodable</span>)]</span>
<span class='kw'>struct</span> <span class='ident'>Job</span> { <span class='ident'>id</span>: <span class='ident'>u64</span> }

<span class='kw'>let</span> <span class='ident'>client</span> <span class='op'>=</span> <span class='ident'>redis</span>::<span class='ident'>Client</span>::<span class='ident'>open</span>(<span class='string'>&quot;redis://127.0.0.1/&quot;</span>).<span class='ident'>unwrap</span>();
<span class='kw'>let</span> <span class='ident'>con</span> <span class='op'>=</span> <span class='ident'>client</span>.<span class='ident'>get_connection</span>().<span class='ident'>unwrap</span>();
<span class='kw'>let</span> <span class='ident'>queue</span> <span class='op'>=</span> <span class='ident'>Queue</span>::<span class='ident'>new</span>(<span class='string'>&quot;default&quot;</span>.<span class='ident'>into</span>(), <span class='ident'>con</span>);

<span class='kw'>while</span> <span class='kw'>let</span> <span class='prelude-val'>Some</span>(<span class='ident'>task</span>) <span class='op'>=</span> <span class='ident'>queue</span>.<span class='ident'>next</span>() {
    <span class='macro'>println</span><span class='macro'>!</span>(<span class='string'>&quot;Working with Job {}&quot;</span>, <span class='ident'>job</span>.<span class='ident'>id</span>);
}</pre>

<p>Fetching a task from a queue returns a wrapper object, which delegates to the underlying,
automatically decoded task object.
If this wrapper object is dropped, the task is considered complete and therefore removed from
the queue.
If the task processing fails, you need to call <code>fail()</code> on this wrapper.</p>

<h3 id='example-task-complete--task-failed' class='section-header'><a href='#example-task-complete--task-failed'>Example: Task complete &amp; task failed</a></h3>
<pre class='rust rust-example-rendered'>
<span class='kw'>struct</span> <span class='ident'>Job</span> { <span class='ident'>id</span>: <span class='ident'>u64</span> }

<span class='kw'>let</span> <span class='ident'>client</span> <span class='op'>=</span> <span class='ident'>redis</span>::<span class='ident'>Client</span>::<span class='ident'>open</span>(<span class='string'>&quot;redis://127.0.0.1/&quot;</span>).<span class='ident'>unwrap</span>();
<span class='kw'>let</span> <span class='ident'>con</span> <span class='op'>=</span> <span class='ident'>client</span>.<span class='ident'>get_connection</span>().<span class='ident'>unwrap</span>();
<span class='kw'>let</span> <span class='ident'>worker</span> <span class='op'>=</span> <span class='ident'>Queue</span>::<span class='ident'>new</span>(<span class='string'>&quot;default&quot;</span>.<span class='ident'>into</span>(), <span class='ident'>con</span>);

{
  <span class='comment'>// `next` gives an Option&lt;Result&lt;...&gt;&gt;</span>
  <span class='kw'>let</span> <span class='ident'>task</span> <span class='op'>=</span> <span class='ident'>worker</span>.<span class='ident'>next</span>().<span class='ident'>unwrap</span>().<span class='ident'>unwrap</span>();
} <span class='comment'>// Task succeeded, removed from backup queue</span>

{
  <span class='kw'>let</span> <span class='ident'>task</span> <span class='op'>=</span> <span class='ident'>worker</span>.<span class='ident'>next</span>().<span class='ident'>unwrap</span>().<span class='ident'>unwrap</span>();
  <span class='ident'>task</span>.<span class='ident'>fail</span>();
} <span class='comment'>// Task failed, stays in backup queue</span></pre>
</div><h2 id='methods'>Methods</h2><h3 class='impl'><code>impl <a class='struct' href='../oppgave/struct.Queue.html' title='oppgave::Queue'>Queue</a></code></h3><div class='impl-items'><h4 id='method.new' class='method'><code>fn <a href='#method.new' class='fnname'>new</a>(name: <a class='struct' href='https://doc.rust-lang.org/nightly/collections/string/struct.String.html' title='collections::string::String'>String</a>, client: <a class='struct' href='../redis/connection/struct.Connection.html' title='redis::connection::Connection'>Connection</a>) -&gt; <a class='struct' href='../oppgave/struct.Queue.html' title='oppgave::Queue'>Queue</a></code></h4>
<div class='docblock'><p>Create a new Queue for the given name</p>
</div><h4 id='method.stop' class='method'><code>fn <a href='#method.stop' class='fnname'>stop</a>(&amp;self)</code></h4>
<div class='docblock'><p>Stop processing the queue</p>

<p>On the next <code>.next()</code> call <code>None</code> will be returned.</p>
</div><h4 id='method.is_stopped' class='method'><code>fn <a href='#method.is_stopped' class='fnname'>is_stopped</a>(&amp;self) -&gt; <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.bool.html'>bool</a></code></h4>
<div class='docblock'><p>Check if queue processing is stopped</p>
</div><h4 id='method.queue' class='method'><code>fn <a href='#method.queue' class='fnname'>queue</a>(&amp;self) -&gt; &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a></code></h4>
<div class='docblock'><p>Get the full queue name</p>
</div><h4 id='method.backup_queue' class='method'><code>fn <a href='#method.backup_queue' class='fnname'>backup_queue</a>(&amp;self) -&gt; &amp;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.str.html'>str</a></code></h4>
<div class='docblock'><p>Get the full backup queue name</p>
</div><h4 id='method.size' class='method'><code>fn <a href='#method.size' class='fnname'>size</a>(&amp;self) -&gt; <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u64.html'>u64</a></code></h4>
<div class='docblock'><p>Get the number of remaining tasks in the queue</p>
</div><h4 id='method.push' class='method'><code>fn <a href='#method.push' class='fnname'>push</a>&lt;T: <a class='trait' href='../oppgave/trait.TaskEncodable.html' title='oppgave::TaskEncodable'>TaskEncodable</a>&gt;(&amp;self, task: T) -&gt; <a class='type' href='../redis/types/type.RedisResult.html' title='redis::types::RedisResult'>RedisResult</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.tuple.html'>()</a>&gt;</code></h4>
<div class='docblock'><p>Push a new task to the queue</p>
</div><h4 id='method.next' class='method'><code>fn <a href='#method.next' class='fnname'>next</a>&lt;T: <a class='trait' href='../oppgave/trait.TaskDecodable.html' title='oppgave::TaskDecodable'>TaskDecodable</a>&gt;(&amp;self) -&gt; <a class='enum' href='https://doc.rust-lang.org/nightly/core/option/enum.Option.html' title='core::option::Option'>Option</a>&lt;<a class='type' href='../redis/types/type.RedisResult.html' title='redis::types::RedisResult'>RedisResult</a>&lt;<a class='struct' href='../oppgave/struct.TaskGuard.html' title='oppgave::TaskGuard'>TaskGuard</a>&lt;T&gt;&gt;&gt;</code></h4>
<div class='docblock'><p>Grab the next task from the queue</p>

<p>This method blocks and waits until a new task is available.</p>
</div></div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "oppgave";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script defer src="../search-index.js"></script>
</body>
</html>